// Generated by CoffeeScript 1.10.0
module.exports.getStrength = function(password) {
  var _at100percent, _at33percent, _at66percent, charsets, passwordStrength, possibleChars, strengthLabel, strengthPercentage;
  if (!password && password !== '') {
    throw new Error('password parameter is missing');
  }
  if (!password.length) {
    return {
      percentage: 0,
      label: 'weak'
    };
  }
  charsets = [
    {
      regexp: /[A-Z]/g,
      size: 26
    }, {
      regexp: /[a-z]/g,
      size: 26
    }, {
      regexp: /[0-9]/g,
      size: 10
    }, {
      regexp: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/g,
      size: 30
    }
  ];
  possibleChars = charsets.reduce(function(possibleChars, charset) {
    if (charset.regexp.test(password)) {
      possibleChars += charset.size;
    }
    return possibleChars;
  }, 0);
  passwordStrength = (Math.log(Math.pow(possibleChars, password.length))) / (Math.log(2));
  _at33percent = 64;
  _at66percent = 128;
  _at100percent = 192;
  if (passwordStrength <= _at33percent) {
    strengthPercentage = passwordStrength * 33 / _at33percent;
    strengthLabel = 'weak';
  } else if (passwordStrength > _at33percent && passwordStrength <= _at66percent) {
    strengthPercentage = passwordStrength * 66 / _at66percent;
    strengthLabel = 'moderate';
  } else {
    strengthPercentage = passwordStrength * 100 / _at100percent;
    if (strengthPercentage > 100) {
      strengthPercentage = 100;
    }
    strengthLabel = 'strong';
  }
  return {
    percentage: strengthPercentage,
    label: strengthLabel
  };
};
