!function(){"use strict";var e="undefined"==typeof window?global:window;if("function"!=typeof e.require){var t={},a={},r={}.hasOwnProperty,i={},o=function(e,t){var a=0;t&&(t.indexOf(!1)&&(a="components/".length),t.indexOf("/",a)>0&&(t=t.substring(a,t.indexOf("/",a))));var r=i[e+"/index.js"]||i[t+"/deps/"+e+"/index.js"];return r?"components/"+r.substring(0,r.length-".js".length):e},n=function(){var e=/^\.\.?(\/|$)/;return function(t,a){var r,i,o=[];r=(e.test(a)?t+"/"+a:a).split("/");for(var n=0,s=r.length;s>n;n++)i=r[n],".."===i?o.pop():"."!==i&&""!==i&&o.push(i);return o.join("/")}}(),s=function(e){return e.split("/").slice(0,-1).join("/")},p=function(t){return function(a){var r=n(s(t),a);return e.require(r,t)}},c=function(e,t){var r={id:e,exports:{}};return a[e]=r,t(r.exports,p(e),r),r.exports},u=function(e,i){var s=n(e,".");if(null==i&&(i="/"),s=o(e,i),r.call(a,s))return a[s].exports;if(r.call(t,s))return c(s,t[s]);var p=n(s,"./index");if(r.call(a,p))return a[p].exports;if(r.call(t,p))return c(p,t[p]);throw new Error('Cannot find module "'+e+'" from "'+i+'"')};u.alias=function(e,t){i[t]=e},u.register=u.define=function(e,a){if("object"==typeof e)for(var i in e)r.call(e,i)&&(t[i]=e[i]);else t[e]=a},u.list=function(){var e=[];for(var a in t)r.call(t,a)&&e.push(a);return e},u.brunch=!0,e.require=u}}(),require.register("application",function(e,t,a){var r,i,o,n,s={}.hasOwnProperty,p=function(e,t){function a(){this.constructor=e}for(var r in t)s.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};o=t("routes"),r=t("views/app_layout"),i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.initialize=function(){return this.on("start",function(e){return function(t){return e.router=new o({app:e}),e.layout=new r,e.layout.render(),Backbone.history&&Backbone.history.start({pushState:!0}),"function"==typeof Object.freeze?Object.freeze(e):void 0}}(this))},t}(Backbone.Marionette.Application),a.exports=n=new i}),require.register("initialize",function(e,t,a){var r,i;r=t("./application"),i=function(){var e,a,r,i;a=$("html").attr("lang");try{r=t("locales/"+a)}catch(o){e=o,r=t("locales/en")}return i=new Polyglot({phrases:r,locale:a}),window.t=i.t.bind(i)},$(function(){return i(),r.start()})}),require.register("lib/state_model",function(e,t,a){var r;a.exports=r=function(){function e(e){this.initialize()}return e.prototype.properties={},e.prototype._cache={},e.prototype.initialize=function(){},e.prototype.get=function(e){return this.properties[e]?this.properties[e]:void 0},e.prototype.add=function(e,t){return this.properties[e]||(this.properties[e]=t,t.onValue(function(t){return function(a){return t._cache[e]=a}}(this))),t},e.prototype.toJSON=function(){return this._cache},e}()}),require.register("lib/timezones",function(e,t,a){a.exports=["Europe/Paris","Europe/Berlin","Europe/Madrid","Europe/Rome","America/Los_Angeles","America/New_York","Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmara","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Atikokan","America/Bahia","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Costa_Rica","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/La_Paz","America/Lima","America/Los_Angeles","America/Maceio","America/Managua","America/Manaus","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Merida","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Vostok","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Choibalsan","Asia/Chongqing","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Gaza","Asia/Harbin","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kashgar","Asia/Kathmandu","Asia/Kolkata","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Canada/Atlantic","Canada/Central","Canada/Eastern","Canada/Mountain","Canada/Newfoundland","Canada/Pacific","Europe/Amsterdam","Europe/Andorra","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Helsinki","Europe/Istanbul","Europe/Kaliningrad","Europe/Kiev","Europe/Lisbon","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/Simferopol","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Uzhgorod","Europe/Vaduz","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zaporozhye","Europe/Zurich","GMT","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Chatham","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis","US/Alaska","US/Arizona","US/Central","US/Eastern","US/Hawaii","US/Mountain","US/Pacific","UTC"]}),require.register("locales/en",function(e,t,a){a.exports={next:"next",skip:"skip",cancel:"cancel","sign up":"sign up","add email":"add email account",welcome:"let me in!",confirm:"confirm","step preset":"settings","step import":"import your datas","step email settings":"configure your email","preset email":"email","preset email tip":"It will be used to contact you if you lose your password.","preset name":"name","preset name tip":"It appears to people when you share files or invite them to events.","preset password":"password","preset password tip":"A strong password of at least 8 characters is required (Special Characters recommended).","preset timezone":"timezone","preset timezone tip":"It's needed to properly display your calendar.","preset opt-in help":"Allow Cozy to use my usage stats to improve the product.","preset opt-out newsletter":"Subscribe to the Beta Cozy Newsletter (Highly recommended).","import google account":"Synchronize your Gmail account & import calendar, contacts and photos from Google","import google account tip":"You'll need to sign in to your Google account to allow your Cozy to access data hosted on Google","import google account sign in":"Sign in to Google","import datas":"Import your current calendars and contacts","import datas tip":"Export your calendars from your current service, and import it into your Cozy. Use the following format: ics, vcardâ€¦","import datas calendar":"import calendars","import datas contacts":"import contacts","leave google title":"Feed your data into Cozy","leave google code content":"Paste the code from Google below:","leave google code":"google code","leave google choice":"Choose what you want to do with your data stored on Google servers:","leave google choice sync gmail":"GMail - Access your email from Cozy","leave google choice contacts":"One-time import of Google Contacts","leave google choice calendar":"One-time import of Google Calendar","leave google choice photos":"One-time import of Google Photos","leave google confirm":"Import data","email caption":"If you want to be able to read your email from your Cozy, we need to set it up.","email email":"email","email email tip":"You can add more emails accounts later.","email password":"password","email server":"imap server","email port":"port","email ssl":"Using SSL?","email show advanced":"Show advanced parameters","email username":"username","email username tip":"Add your IMAP username, if it is different from your email address","login welcome":"Welcome","login enter your password":"Please enter your password to access to your Cozy","login password":"password","login submit":"sign in","login recover":"Forget password? Email me instructions","login recover again":"Did not receive it? Send it again","login recover sent title":"Email sent","login recover sent message":"Please check your email, follow instructions to reset your password","login wrong password title":"Wrong password","login wrong password message":"The pasword you entered  is incorrect, please try again","reset welcome":"Reset password","reset enter your password":"Please enter your new password to reset it","reset password":"password","reset submit":"reset your password","reset wrong password title":"Your password can't be resetted","reset wrong password message":"The pasword you entered is incorrect, or your reset token is expired","setup title":"We're setting up your Cozy!","setup message":"You are now close to have your own personal cloud where your data are stored.","setup on mobile title":"Use Cozy on your Android device!","setup on mobile message":"Check out our mobile app on Google Play:","welcome title":"Congratulations on taking back control of your personal data.","welcome message":"With Cozy, you can store your data on your personal Cloud that you control. As opposed to most commercial Cloud services,  there is no data-mining taking place on your Cozy Cloud, so no large corporation is trying to learn everything from you by searching through your data when it's stored here"}}),require.register("routes/index",function(e,t,a){var r,i,o,n,s,p={}.hasOwnProperty,c=function(e,t){function a(){this.constructor=e}for(var r in t)p.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};o=t("views/register"),i=t("views/auth"),n=t("states/registration"),r=t("states/auth"),a.exports=s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.routes={"login(*path)(?next=*path)":"login","password/reset/:key":"resetPassword","register(?step=:step)":"register"},t.prototype.initialize=function(e){return this.app=e.app},t.prototype.auth=function(e){var t;return t=new r,this.app.layout.showChildView("content",new i(_.extend(e,{model:t})))},t.prototype.login=function(e){return this.auth({next:e,backend:"/login",type:"login"})},t.prototype.resetPassword=function(e){return this.auth({next:"/login",backend:window.location.pathname,type:"reset"})},t.prototype.register=function(e){var t,a;return null==e&&(e="preset"),t=this.app.layout.getChildView("content"),null!=t&&t instanceof o||(a=new n,a.get("step").map(function(e){return e?"register?step="+e:void 0}).assign(this,"navigate"),t=new o({model:a}),this.app.layout.showChildView("content",t)),t.model.setStep(e)},t}(Backbone.Router)}),require.register("states/auth",function(e,t,a){var r,i,o={}.hasOwnProperty,n=function(e,t){function a(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};i=t("lib/state_model"),a.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.initialize=function(){return this.alert=new Bacon.Bus,this.recover=new Bacon.Bus,this.add("alert",this.alert.toProperty()),this.add("recover",this.recover.toProperty(!1))},t}(i)}),require.register("states/registration",function(e,t,a){var r,i,o={}.hasOwnProperty,n=function(e,t){function a(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};i=t("lib/state_model"),a.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.steps={preset:{next:"import",nextLabel:"sign up"},"import":{next:"email",nextLabel:"skip"},import_google:{nocontrols:!0},email:{next:"setup",nextLabel:"skip"},setup:{next:"welcome",nocontrols:!0},welcome:{nextLabel:"welcome"}},t.prototype.initialize=function(){var e,t,a,r;return this.buttonEnabled=new Bacon.Bus,this.buttonBusy=new Bacon.Bus,this.isRegistered=new Bacon.Bus,this.nextButtonLabel=new Bacon.Bus,this.setStepBus=new Bacon.Bus,e=this.isRegistered.startWith(!0).toProperty(),r=Bacon.update(null,[this.setStepBus.filter(e)],function(e,t){return null!=t?t:e}),this.add("step",r),this.add("nextStep",t=r.map(function(e){return function(t){var a;return(null!=(a=e.steps[t])?a.next:void 0)||null}}(this))),this.add("hasControls",r.map(function(e){return function(t){var a;return!(null!=(a=e.steps[t])?a.nocontrols:void 0)}}(this))),this.setStepBus.plug(t.sampledBy(this.isRegistered)),this.buttonEnabled.plug(r.map(function(e){return function(e){return"preset"!==e}}(this))),this.buttonEnabled.startWith(!0),this.buttonBusy.startWith(!1),a=Bacon.update("next",[this.nextButtonLabel],function(e,t){return t?t:e}),this.add("nextButtonLabel",a),this.nextButtonLabel.plug(r.map(function(e){return function(t){var a;return null!=(a=e.steps[t])?a.nextLabel:void 0}}(this)))},t.prototype.setStep=function(e){return this.setStepBus.push(e)},t}(i)}),require.register("views/app_layout",function(e,t,a){var r,i={}.hasOwnProperty,o=function(e,t){function a(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return o(a,e),a.prototype.template=t("views/templates/layout_app"),a.prototype.el="[role=application]",a.prototype.regions={content:".container"},a}(Mn.LayoutView)}),require.register("views/auth/feedback",function(e,a,r){var i,o=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,s=function(e,t){function a(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};r.exports=i=function(e){function r(){return this.sendResetPassword=o(this.sendResetPassword,this),r.__super__.constructor.apply(this,arguments)}return s(r,e),r.prototype.template=a("views/templates/view_auth_feedback"),r.prototype.ui={forgot:"a.forgot"},r.prototype.serializeData=function(){return _.extend(this.model.toJSON(),{forgot:this.options.forgot})},r.prototype.initialize=function(){var e;return this.model.get("alert").subscribe(this.render),this.model.get("recover").subscribe(this.render),this.model.alert.map(".status").assign(this.$el,"attr","class"),e=this.$el.asEventStream("click",this.ui.forgot).doAction(".preventDefault").subscribe(this.sendResetPassword)},r.prototype.sendResetPassword=function(){var e;return e=Bacon.fromPromise($.post("/login/forgot")),this.model.alert.plug(e.map({status:"success",title:t("login recover sent title"),message:t("login recover sent message")})),e.map(t("login recover again")).onValue(function(e){return function(t){return e.ui.forgot.text(t)}}(this))},r}(Mn.ItemView)}),require.register("views/auth/index",function(e,a,r){var i,o,n=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,p=function(e,t){function a(){this.constructor=e}for(var r in t)s.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};o=a("views/auth/feedback"),r.exports=i=function(e){function r(){return this.authenticate=n(this.authenticate,this),r.__super__.constructor.apply(this,arguments)}return p(r,e),r.prototype.tagName="form",r.prototype.className=function(){return this.options.type},r.prototype.attributes=function(){var e;return e={method:"POST",action:this.options.backend}},r.prototype.template=a("views/templates/view_auth"),r.prototype.regions={feedback:".feedback"},r.prototype.ui={passwd:"input[type=password]",submit:".controls button[type=submit]"},r.prototype.initialize=function(e){var t;return null==(t=this.options).next&&(t.next="/"),this.options.forgot="login"===this.options.type,this.password=this.$el.asEventStream("keyup blur",this.ui.passwd).map(function(e){return e.target.value}).toProperty(""),this.passwordEntered=this.password.map(function(e){return e.length>0}),this.submit=this.$el.asEventStream("click",this.ui.submit).doAction(".preventDefault").filter(this.passwordEntered).map(this.password).onValue(this.authenticate)},r.prototype.onRender=function(){return this.passwordEntered.not().assign(this.ui.submit,"attr","aria-disabled"),this.showChildView("feedback",new o({forgot:this.options.forgot,model:this.model}))},r.prototype.serializeData=function(){var e;return e={username:window.username,prefix:this.options.type}},r.prototype.authenticate=function(e){var a,r;return r=JSON.stringify({password:e}),a=Bacon.fromPromise($.post(this.options.backend,r)),a.map(".success").onValue(function(e){return function(){return window.location.pathname=e.options.next}}(this)),this.model.alert.plug(a.mapError({status:"error",title:t(""+this.options.type+" wrong password title"),message:t(""+this.options.type+" wrong password message")}))},r}(Mn.LayoutView)}),require.register("views/register/controls",function(e,a,r){var i,o={}.hasOwnProperty,n=function(e,t){function a(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};r.exports=i=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,e),r.prototype.template=a("views/templates/view_register_controls"),r.prototype.ui={next:"a.btn"},r.prototype.initialize=function(){var e;return this.isWelcome=this.model.get("step").map(function(e){return"welcome"===e}),e=this.$el.asEventStream("click",this.ui.next).doAction(".preventDefault").map(function(e){return e.target.href.split("=")[1]}).filter(this.model.buttonEnabled.toProperty()),this.model.nextClickStream=e,this.model.setStepBus.plug(e.filter(this.isWelcome.not())),e.map(this.isWelcome).onValue(function(e){return e?window.location.pathname="/":void 0})},r.prototype.onRender=function(){var e;return this.model.buttonEnabled.toProperty().not().assign(this.ui.next,"attr","aria-disabled"),this.model.buttonBusy.toProperty().assign(this.ui.next,"attr","aria-busy"),this.model.get("nextStep").map(function(e){return e?"register?step="+e:"/"}).assign(this.ui.next,"attr","href"),this.model.get("nextButtonLabel").map(function(e){return function(){return t(e)}}).assign(this.ui.next,"text"),e=this.model.get("nextButtonLabel").map(function(e){return"skip"===e}),e.assign(this.ui.next,"toggleClass","btn-secondary"),e.not().assign(this.ui.next,"toggleClass","btn-primary")},r}(Mn.ItemView)}),require.register("views/register/email",function(e,t,a){var r,i,o={}.hasOwnProperty,n=function(e,t){function a(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};i=function(e){var t;return t=function(e){return"checkbox"===e.type?e.checked:e.value},e.map(function(){return $(this).asEventStream("keyup blur").map(function(e){return t(e.target)}).toProperty(t(this))}).get()},a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return n(a,e),a.prototype.tagName="form",a.prototype.className="email",a.prototype.template=t("views/templates/view_register_email"),a.prototype.ui={legend:".advanced legend",adv:".advanced .content",required:"input[required]",inputs:"input",email:"#email-email",ssl:"#email-ssl",port:"#email-port"},a.prototype.initialize=function(){return this.isEmail=this.model.get("step").map(function(e){return"email"===e||"setup"===e}),this.showAdv=this.$el.asEventStream("click",this.ui.legend).scan(!1,function(e){return!e})},a.prototype.onRender=function(){var e,t,a;return this.showAdv.not().assign(this.ui.adv,"attr","aria-hidden"),this.showAdv.assign(this.ui.legend,"attr","aria-hidden"),this.model.get("email").assign(this.ui.email,"val"),this.ui.ssl.asEventStream("change").map(function(e){return e.target.checked?993:143}).assign(this.ui.port,"val"),a=i(this.ui.required),t=_.reduce(a,function(e,t){return e.and(t.map(function(e){return e.length>0}))},Bacon.constant(!0)),this.model.nextButtonLabel.plug(t.map(function(e){return e?"add email":"skip"})),e=i(this.ui.inputs),Bacon.combineAsArray(e).filter(t).sampledBy(this.model.nextClickStream).filter(this.isEmail).onValue(this.onSubmit)},a.prototype.onSubmit=function(e){var t,a;return t={email:e[0],password:e[1],server:e[2],port:e[3],ssl:e[4],username:e[5]},a=Bacon.fromPromise($.post("/register/email",JSON.stringify(t)))},a}(Mn.ItemView)}),require.register("views/register/feedback",function(e,t,a){var r,i={}.hasOwnProperty,o=function(e,t){function a(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return o(a,e),a.prototype.template=t("views/templates/view_register_feedback"),a.prototype.onRender=function(){return this.model.get("step").map(function(e){return function(){return this.classList.contains(e)}}).assign(this.$("li"),"attr","aria-selected"),this.model.get("step").map(function(e){return/^welcome/.test(e)}).assign(this.$el,"attr","aria-hidden")},a}(Mn.ItemView)}),require.register("views/register/import",function(e,t,a){var r,i={}.hasOwnProperty,o=function(e,t){function a(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return o(a,e),a.prototype.className="import",a.prototype.template=t("views/templates/view_register_import"),a.prototype.ui={google:"#import-google"},a.prototype.initialize=function(){var e;return e=this.$el.asEventStream("click",this.ui.google).doAction(".preventDefault").map(function(e){return e.target.href.split("=")[1]}),this.model.setStepBus.plug(e)},a}(Mn.ItemView)}),require.register("views/register/import_google",function(e,t,a){var r,i={}.hasOwnProperty,o=function(e,t){function a(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return o(a,e),a.prototype.className="import-google",a.prototype.template=t("views/templates/view_register_import_google"),a.prototype.events={"click #lg-ok":"selectedScopes","click #step-pastecode-ok":"pastedCode","click #cancel":"cancel"},a.prototype.pastedCode=function(e){var t;return e.preventDefault(),null!=(t=this.popup)&&t.close(),this.changeStep("pickscope"),this.auth_code=this.$("input:text[name=auth_code]").val(),this.$("input:text[name=auth_code]").val("")},a.prototype.selectedScopes=function(e){var t;return e.preventDefault(),t={photos:this.$("input:checkbox[name=photos]").prop("checked"),calendars:this.$("input:checkbox[name=calendars]").prop("checked"),contacts:this.$("input:checkbox[name=contacts]").prop("checked"),sync_gmail:this.$("input:checkbox[name=sync_gmail]").prop("checked")},$.post("/apps/leave-google/lg",{auth_code:this.auth_code,scope:t}),this.model.setStep("setup")},a.prototype.changeStep=function(e){return this.$(".step").hide(),this.$("#step-"+e).show(),"pastecode"===e?this.$("#auth_code").focus():void 0},a.prototype.cancel=function(){return this.model.setStep("import")},a.prototype.onRender=function(){var e,t;return this.changeStep("pastecode"),t=["toolbars=0","width=700","height=600","left=200","top=200","scrollbars=1","resizable=1"].join(","),e="https://accounts.google.com/o/oauth2/auth?scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcalendar.readonly%20https%3A%2F%2Fpicasaweb.google.com%2Fdata%2F%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcontacts.readonly%20email%20profile&response_type=code&client_id=260645850650-2oeufakc8ddbrn8p4o58emsl7u0r0c8s.apps.googleusercontent.com&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob",this.popup=window.open(e,"Google OAuth",t),this.changeStep("pastecode")},a}(Mn.ItemView)}),require.register("views/register/index",function(e,t,a){var r,i,o,n=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,p=function(e,t){function a(){this.constructor=e}for(var r in t)s.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};r=t("views/register/controls"),i=t("views/register/feedback"),a.exports=o=function(e){function a(){return this.swapStep=n(this.swapStep,this),a.__super__.constructor.apply(this,arguments)}return p(a,e),a.prototype.className="register",a.prototype.template=t("views/templates/view_base"),a.prototype.regions={content:"[role=region]",controls:".controls",feedback:".feedback"},a.prototype.ui={footer:"footer"},a.prototype.initialize=function(){return this.model.get("step").onValue(this.swapStep)},a.prototype.onRender=function(){return this.showChildView("controls",new r({model:this.model})),this.showChildView("feedback",new i({model:this.model})),this.model.get("hasControls").not().assign(this.ui.footer,"attr","aria-hidden")},a.prototype.swapStep=function(e){var a;if(e)return a=t("views/register/"+e),this.showChildView("content",new a({model:this.model}))},a}(Mn.LayoutView)}),require.register("views/register/preset",function(e,t,a){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,n=function(e,t){function a(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return this.onSubmit=i(this.onSubmit,this),a.__super__.constructor.apply(this,arguments)}return n(a,e),a.prototype.tagName="form",a.prototype.className="preset",a.prototype.attributes={method:"post",action:"/register"},a.prototype.template=t("views/templates/view_register_preset"),a.prototype.ui={email:"#preset-email",name:"#preset-name",password:"#preset-password",timezone:"#preset-timezone"},a.prototype.initialize=function(){return this.isPreset=this.model.get("step").map(function(e){return"preset"===e}),this.model.isRegistered.push(!1),this.submitStream=this.$el.asEventStream("submit").doAction(".preventDefault").filter(this.model.buttonEnabled.toProperty()),this.model.add("email",this.$el.asEventStream("blur",this.ui.email).map(".target.value").toProperty(""))},a.prototype.onRender=function(){var e,t;return t=_.map(this.ui,function(e){return function(e,t){return e.asEventStream("keyup blur").map(".target.value").toProperty("")}}(this)),e=_.reduce(t,function(e,t){return e.and(t.map(function(e){return e.length>0}))},Bacon.constant(!0)),this.model.buttonEnabled.plug(e.changes()),Bacon.combineAsArray(t).filter(function(e){return _.compact(e).length===e.length}).sampledBy(this.model.nextClickStream.merge(this.submitStream)).filter(this.isPreset).onValues(this.onSubmit)},a.prototype.serializeData=function(){var e;return e={timezones:t("lib/timezones")}},a.prototype.onSubmit=function(e,t,a,r){var i,o,n;return this.model.buttonBusy.push(!0),i={email:e,public_name:t,timezone:r,password:a},n=Bacon.fromPromise($.post("/register",JSON.stringify(i))),
this.model.isRegistered.plug(n.map(!0)),this.model.buttonBusy.plug(n.mapEnd(!1)),o=n.mapError(".responseJSON.error").map(function(e){return o={email:/email/.test(e),timezone:/timezone/.test(e)}}),o.map(".email").assign(this.ui.email.parent(),"toggleClass","error"),o.map(".timezone").assign(this.ui.timezone.parent(),"toggleClass","error")},a}(Mn.ItemView)}),require.register("views/register/setup",function(e,t,a){var r,i={}.hasOwnProperty,o=function(e,t){function a(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return o(a,e),a.prototype.className="setup",a.prototype.template=t("views/templates/view_register_setup"),a.prototype.ui={bar:"progress"},a.prototype.initialize=function(){var e;return this.timer=Bacon.interval(80,1).take(100).scan(0,function(e,t){return e+t}),e=this.timer.filter(function(e){return e>=100}).map(this.model.steps.setup.next),this.model.setStepBus.plug(e)},a.prototype.onRender=function(){return this.timer.assign(this.ui.bar,"val")},a}(Mn.ItemView)}),require.register("views/register/welcome",function(e,t,a){var r,i={}.hasOwnProperty,o=function(e,t){function a(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};a.exports=r=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return o(a,e),a.prototype.className="welcome",a.prototype.template=t("views/templates/view_register_welcome"),a}(Mn.ItemView)}),require.register("views/templates/layout_app",function(e,t,a){var r=function(e){var t=[];return t.push('<section class="popup"><header></header><div class="container"></div></section>'),t.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof a&&a&&a.exports&&(a.exports=r)}),require.register("views/templates/view_auth",function(e,a,r){var i=function(e){var a,r=[],i=e||{},o=i.prefix,n=i.username;return r.push('<div role="region"><h1>'+jade.escape(null==(a=t(o+" welcome"))?"":a)+" "+jade.escape(null==(a=n)?"":a)+'</h1><p id="login-password-tip" class="help">'+jade.escape(null==(a=t(o+" enter your password"))?"":a)+"</p><label"+jade.attr("for",""+o+"-password",!0,!1)+jade.attr("aria-describedby",""+o+"-password-tip",!0,!1)+' class="with-input"><span>'+jade.escape(null==(a=t(o+" password"))?"":a)+"</span><input"+jade.attr("id",""+o+"-password",!0,!1)+' type="password"/></label></div><footer><div class="controls"><button type="submit" class="btn btn-primary">'+jade.escape(null==(a=t(o+" submit"))?"":a)+'</button></div><div class="feedback"></div></footer>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_auth_feedback",function(e,a,r){var i=function(e){var a,r=[],i=e||{},o=i.alert,n=i.forgot,s=i.label,p=i.recover;return o&&r.push('<div class="alert"><p><strong>'+jade.escape(null==(a=o.title)?"":a)+"</strong></p><p>"+jade.escape(null==(a=o.message)?"":a)+"</p></div>"),n&&(r.push('<div class="recover">'),s=t(p.label?"login recover again":"login recover"),r.push('<a href="/login/forgot" class="forgot">'+jade.escape(null==(a=s)?"":a)+"</a></div>")),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_base",function(e,t,a){var r=function(e){var t=[];return t.push('<div role="region"></div><footer><div class="controls"></div><div class="feedback"></div></footer>'),t.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof a&&a&&a.exports&&(a.exports=r)}),require.register("views/templates/view_register_controls",function(e,a,r){var i=function(e){var a,r=[];return r.push('<a href="/register?step=null" class="btn btn-primary">'+jade.escape(null==(a=t("next"))?"":a)+"</a>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_email",function(e,a,r){var i=function(e){var a,r=[];return r.push("<h2>"+jade.escape(null==(a=t("email caption"))?"":a)+'</h2><label for="email-email" aria-describedby="email-email-tip" class="with-input"><span>'+jade.escape(null==(a=t("email email"))?"":a)+'</span><input id="email-email" type="email" required="required"/><span class="indicator"></span></label><label for="email-password" class="with-input"><span>'+jade.escape(null==(a=t("email password"))?"":a)+'</span><input id="email-password" type="password" required="required"/><span class="indicator"></span></label><div class="input-group input-group-02-third"><label for="email-server" class="with-input"><span>'+jade.escape(null==(a=t("email server"))?"":a)+'</span><input id="email-server" type="text" required="required"/><span class="indicator"></span></label><label for="email-port" class="with-input"><span>'+jade.escape(null==(a=t("email port"))?"":a)+'</span><input id="email-port" type="number" required="required" value="993"/><span class="indicator"></span></label></div><label for="email-ssl" class="checkbox"><input id="email-ssl" type="checkbox" checked="checked"/><span>'+jade.escape(null==(a=t("email ssl"))?"":a)+'</span></label><fieldset class="advanced"><legend>'+jade.escape(null==(a=t("email show advanced"))?"":a)+'</legend><div class="content"><label for="email-username" aria-describedby="email-username-tip" class="with-input"><span>'+jade.escape(null==(a=t("email username"))?"":a)+'</span><input id="email-username" type="text"/><span class="indicator"></span></label><p id="email-username-tip" class="tips">'+jade.escape(null==(a=t("email username tip"))?"":a)+'</p></div></fieldset><p id="email-email-tip" class="tips">'+jade.escape(null==(a=t("email email tip"))?"":a)+"</p>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_feedback",function(e,a,r){var i=function(e){var a,r=[];return r.push('<ul><li class="preset">'+jade.escape(null==(a=t("step preset"))?"":a)+'</li><li class="import">'+jade.escape(null==(a=t("step import"))?"":a)+'</li><li class="email">'+jade.escape(null==(a=t("step email settings"))?"":a)+"</li></ul>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_import",function(e,a,r){var i=function(e){var a,r=[];return r.push('<div id="import-google" class="content-block"><div class="content-illustration google-services"></div><h2>'+jade.escape(null==(a=t("import google account"))?"":a)+"</h2><p>"+jade.escape(null==(a=t("import google account tip"))?"":a)+'</p><a id="import-google" type="button" href="/register?step=import_google" class="btn btn-primary">'+jade.escape(null==(a=t("import google account sign in"))?"":a)+"</a></div>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_import_google",function(e,a,r){var i=function(e){var a,r=[];return r.push('<div id="import-google" class="content-block"><h2>'+jade.escape(null==(a=t("leave google title"))?"":a)+'</h2><section id="step-pastecode" class="step"><p>'+jade.escape(null==(a=t("leave google code content"))?"":a)+'</p><form><label for="google-code" class="with-input"><span>'+jade.escape(null==(a=t("leave google code"))?"":a)+'</span><input id="auth_code" type="text" name="auth_code" required="required" autofocus="autofocus"/></label><div class="btn-group btn-group-02"><button id="cancel" class="btn btn-secondary">'+jade.escape(null==(a=t("cancel"))?"":a)+'</button><button id="step-pastecode-ok" class="btn btn-primary">'+jade.escape(null==(a=t("confirm"))?"":a)+'</button></div></form></section><section id="step-pickscope" class="step google-services-list"><p>'+jade.escape(null==(a=t("leave google choice"))?"":a)+'</p><label for="google-gmail-sync"><input id="google-gmail-sync" type="checkbox" name="sync_gmail" value="sync_gmail" checked="checked"/><span class="google-services-icons gmail"></span><span>'+jade.escape(null==(a=t("leave google choice sync gmail"))?"":a)+'</span></label><label for="google-contacts-import"><input id="google-contacts-import" type="checkbox" name="contacts" value="contacts" checked="checked"/><span class="google-services-icons contacts"></span><span>'+jade.escape(null==(a=t("leave google choice contacts"))?"":a)+'</span></label><label for="google-calendar-import"><input id="google-calendar-import" type="checkbox" name="calendars" value="calendars" checked="checked"/><span class="google-services-icons calendar"></span><span>'+jade.escape(null==(a=t("leave google choice calendar"))?"":a)+'</span></label><label for="google-photos-import"><input id="google-photos-import" type="checkbox" name="photos" value="photos" checked="checked"/><span class="google-services-icons photos"></span><span>'+jade.escape(null==(a=t("leave google choice photos"))?"":a)+'</span></label><div class="btn-group btn-group-02"><button id="cancel" class="btn btn-secondary">'+jade.escape(null==(a=t("cancel"))?"":a)+'</button><button id="lg-ok" class="btn btn-primary">'+jade.escape(null==(a=t("leave google confirm"))?"":a)+"</button></div></section></div>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_preset",function(e,a,r){var i=function(e){var a,r=[],i=e||{},o=i.timezones;return r.push('<label for="preset-email" aria-describedby="preset-email-tip" class="with-input"><span>'+jade.escape(null==(a=t("preset email"))?"":a)+'</span><input id="preset-email" type="email"/><span class="indicator"><span class="fa fa-exclamation-triangle"></span></span></label><p id="preset-email-tip" class="tips">'+jade.escape(null==(a=t("preset email tip"))?"":a)+'</p><label for="preset-name" aria-describedby="preset-name-tip" class="with-input"><span>'+jade.escape(null==(a=t("preset name"))?"":a)+'</span><input id="preset-name" type="text"/></label><p id="preset-name-tip" class="tips">'+jade.escape(null==(a=t("preset name tip"))?"":a)+'</p><label for="preset-password" aria-describedby="preset-password-tip" class="with-input"><span>'+jade.escape(null==(a=t("preset password"))?"":a)+'</span><input id="preset-password" type="password"/></label><p id="preset-email-tip" class="tips">'+jade.escape(null==(a=t("preset password tip"))?"":a)+'</p><label for="preset-timezone" aria-describedby="preset-timezone-tip" class="with-input"><span>'+jade.escape(null==(a=t("preset timezone"))?"":a)+'</span><input id="preset-timezone" type="text" list="preset-timezone-datalist"/><datalist id="preset-timezone-datalist">'),function(){var e=o;if("number"==typeof e.length)for(var t=0,a=e.length;a>t;t++){var i=e[t];r.push("<option"+jade.attr("value",i,!0,!1)+"></option>")}else{var a=0;for(var t in e){a++;var i=e[t];r.push("<option"+jade.attr("value",i,!0,!1)+"></option>")}}}.call(this),r.push('</datalist><span class="indicator"><span class="fa fa-exclamation-triangle"></span></span></label><p id="preset-timezone-tip" class="tips">'+jade.escape(null==(a=t("preset timezone tip"))?"":a)+'</p><div class="checkboxes"><label for="preset-help-us" class="checkbox"><input id="preset-help-us" type="checkbox" checked="checked"/><span>'+jade.escape(null==(a=t("preset opt-in help"))?"":a)+'</span></label><label for="preset-mailing" class="checkbox"><input id="preset-mailing" type="checkbox"/><span>'+jade.escape(null==(a=t("preset opt-out newsletter"))?"":a)+'</span></label></div><button type="submit" aria-hidden="true"></button>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_setup",function(e,a,r){var i=function(e){var a,r=[];return r.push("<h1>"+jade.escape(null==(a=t("setup title"))?"":a)+'</h1><p class="help">'+jade.escape(null==(a=t("setup message"))?"":a)+'</p><progress value="0" max="100"></progress><h1>'+jade.escape(null==(a=t("setup on mobile title"))?"":a)+'</h1><p class="help">'+jade.escape(null==(a=t("setup on mobile message"))?"":a)+'</p><a href="https://play.google.com/store/apps/details?id=io.cozy.files_client" target="_blank" class="btn-store"><img src="/img/google-play-btn.svg" alt="Get it on Google Play"/></a>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/view_register_welcome",function(e,a,r){var i=function(e){var a,r=[];return r.push("<h1>"+jade.escape(null==(a=t("welcome title"))?"":a)+'</h1><p class="help">'+jade.escape(null==(a=t("welcome message"))?"":a)+"</p>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)});